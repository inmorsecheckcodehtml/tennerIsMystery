<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>tennerIsMystery</title>
<style>
:root{--bg:#000;--panel:#070707;--accent:#33ff66;--muted:#0c0c0c}
html,body{height:100%;margin:0;background:linear-gradient(180deg,#000,#020202);font-family:ui-monospace, SFMono-Regular, Menlo, Monaco, "Roboto Mono", monospace;color:var(--accent)}
.wrap{height:100%;display:flex;align-items:center;justify-content:center}
.popup{
  width:min(780px,94vw);
  background:linear-gradient(180deg,var(--panel),#0b0b0b);
  border:2px solid rgba(51,255,102,0.12);
  box-shadow:0 20px 60px rgba(0,0,0,0.9),0 0 40px rgba(51,255,102,0.03) inset;
  padding:28px;border-radius:12px;backdrop-filter: blur(2px);
}
h1{margin:0 0 8px 0;font-size:1.6rem;letter-spacing:1px}
.subtitle{font-size:.9rem;margin-bottom:18px;color:rgba(51,255,102,0.9)}
.subtitle a{color:inherit;text-decoration:none;cursor:pointer}
.code{
  background:#000;border:1px dashed rgba(51,255,102,0.08);padding:18px;border-radius:8px;min-height:120px;
  display:flex;flex-direction:column;gap:8px;
  white-space:pre-wrap;font-size:0.95rem;line-height:1.3;color:var(--accent);
}
.btns{margin-top:18px;display:flex;gap:10px}
button{background:transparent;border:1px solid rgba(51,255,102,0.12);color:var(--accent);padding:8px 12px;border-radius:8px;cursor:pointer}
button:hover{border-color:rgba(51,255,102,0.28);transform:translateY(-2px)}
.hint{margin-top:12px;color:rgba(51,255,102,0.45);font-size:.85rem}
@media (max-width:460px){.popup{padding:16px}}
</style>
</head>
<body>
<div class="wrap">
  <div class="popup" role="dialog" aria-label="tennerIsMystery">
    <h1>tennerIsMystery</h1>

    <!-- Braille subtitle triggers forced download -->
    <div class="subtitle">
      <a id="downloadLink" href="adventure.zip">
        ⠠⠽⠕⠥⠗⠀⠝⠑⠭⠞⠀⠁⠙⠧⠑⠝⠞⠥⠗⠑
      </a>
    </div>

    <div class="code" id="codeBox" aria-live="polite"></div>

    <div class="btns">
      <button id="enterBtn">Click to enter (fullscreen)</button>
      <button id="popupBtn">Open in small window</button>
      <button id="revealBtn">Reveal plain text</button>
    </div>

    <div class="hint">01111001 01101111 01110101 01110010 01100101 00100000 01101111 01101110 01100101 00100000 01110011 01110100 01100101 01110000 00100000 01100011 01101100 01101111 01110011 01100101 01110010 00100000 01110100 01101111 00100000 01110100 01101000 01100101 00100000 01101101 01111001 01110011 01110100 01100101 01110010 01111001</div>
  </div>
</div>

<script>
// Test JS is running
alert("JS loaded!");

// typing animation lines
const lines = [
  'tennerIsMystery',
  '⠠⠽⠕⠥⠗⠀⠝⠑⠭⠞⠀⠁⠙⠧⠑⠝⠞⠥⠗⠑',
  '01111001 01101111 01110101 01110010 01100101 00100000 01101111 01101110 01100101 00100000 01110011 01110100 01100101 01110000 00100000 01100011 01101100 01101111 01110011 01100101 01110010 00100000 01110100 01101111 00100000 01110100 01101000 01100101 00100000 01101101 01111001 01110011 01110100 01100101 01110010 01111001'
];

const box = document.getElementById('codeBox');

function typeLines(lines,speed=14){
  box.textContent='';
  let i=0;
  function typeLine(){
    if(i>=lines.length) return;
    const line=lines[i],node=document.createElement('div');
    box.appendChild(node);
    let pos=0;
    const t=setInterval(()=>{
      node.textContent=line.slice(0,pos+1);
      pos++;
      if(pos>=line.length){
        clearInterval(t);
        i++;
        setTimeout(typeLine,450);
      }
    },speed);
  }
  typeLine();
}
typeLines(lines,14);

// fullscreen
document.getElementById('enterBtn').addEventListener('click',async()=>{
  if(document.documentElement.requestFullscreen){
    try{await document.documentElement.requestFullscreen()}catch(e){}
  }
  typeLines(lines,8);
});

// popup window
document.getElementById('popupBtn').addEventListener('click',()=>{
  window.open(location.href,'tennerPopup','toolbar=no,menubar=no,scrollbars=no,resizable=no,width=600,height=420');
});

// reveal binary
document.getElementById('revealBtn').addEventListener('click',()=>{
  const binary=lines[2].split(' ');
  try{
    const text=binary.map(b=>String.fromCharCode(parseInt(b,2))).join('');
    alert('Decoded: '+text);
  }catch(e){alert('Could not decode binary.')}
});

// braille download
document.getElementById('downloadLink').addEventListener('click',async function(e){
  e.preventDefault();
  const url=this.href;
  try{
    const response=await fetch(url);
    const blob=await response.blob();
    const a=document.createElement('a');
    a.href=URL.createObjectURL(blob);
    a.download='adventure.zip';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(a.href);
  }catch(err){alert('Failed to download ZIP. Open directly: '+url);}
});

// draggable panel
let isDown=false,startX,startY;
const panel=document.querySelector('.popup');
panel.addEventListener('pointerdown',e=>{isDown=true;startX=e.clientX;startY=e.clientY;panel.setPointerCapture(e.pointerId);});
panel.addEventListener('pointermove',e=>{if(!isDown) return; const dx=e.clientX-startX,dy=e.clientY-startY;panel.style.transform=`translate(${dx}px,${dy}px)`;});
panel.addEventListener('pointerup',e=>{isDown=false;panel.releasePointerCapture(e.pointerId);setTimeout(()=>panel.style.transform='none',250);});
</script>
</body>
</html>
